<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-US">

<!--     -->
<head>
<!-- GenHTML revision 23436-->
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1">
<title>Optional: Customize Build Specifications - OpenSolaris 2010.03 Distribution Constructor Guide</title>
<meta name="robots" content="index,follow">
<meta name="robots" content="index,follow">
<meta name="date" content="2010-03-01">
<meta name="collection" content="reference">
<link rel="stylesheet" type="text/css" href="css/elements.css">
<link rel="stylesheet" type="text/css" href="css/opensol.css">
</head>

<body>


<div class="Masthead">
   <div class="MastheadLogo">
      <a href="http://www.opensolaris.com"><img border="0" src="graphics/opensolaris_logo_trans.png"></img></a>
   </div>
   <div class="Title">OpenSolaris 2010.03 Distribution Constructor Guide</div>
</div>
<div class="headerbar"></div>


<table class="Layout" border="0" cellspacing="0" width="100%">
<tbody>

   <tr valign="top" class="PageControls">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="bootimage.html">Previous</a>
             </td>
             <td align="right">
                 <a href="buildvmc.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
   
   <tr valign="top">
      <td class="Navigation" width="200px"><p class="toc level1"><a href="docinfo.html">Document Information</a></p>
<p class="toc level1 tocsp"><a href="index.html">1.&nbsp;&nbsp;Introduction to the Distribution Constructor</a></p>
<p class="toc level1 tocsp"><a href="using.html">2.&nbsp;&nbsp;Design and Build OpenSolaris Images</a></p>
<p class="toc level1 tocsp"><a href="vm.html">3.&nbsp;&nbsp;x86: Design and Build a Virtual Machine</a></p>
<p class="toc level2"><a href="whatis.html">What is a Virtual Machine?</a></p>
<p class="toc level2"><a href="vmsysreq.html">System Requirements for Building Virtual Machines</a></p>
<p class="toc level2"><a href="buildvm.html">How to Build a Virtual Machine</a></p>
<p class="toc level2"><a href="bootimage.html">Get an AI Boot Image</a></p>
<div id="scrolltoc" class="onpage">
<p class="toc level2"><a href="">Optional: Customize Build Specifications</a></p>
</div>
<p class="toc level2"><a href="buildvmc.html">Build the Virtual Machine</a></p>
<p class="toc level2"><a href="troublevm.html">Troubleshooting During the Build</a></p>
<p class="toc level2"><a href="vmcblog.html">Further Information</a></p>
<p class="toc level1 tocsp"><a href="appendix.html">A.&nbsp;&nbsp;Custom Finalizer Scripts -- Examples</a></p>
</td>
      <td class="ContentPane" width="705px">

	 <div class="MainContent">      	 
             

<a name="customvmc"></a><h3>Optional: Customize Build Specifications</h3>
<p>You may choose to customize some of the other specifications in the virtual
machine manifest file. You can make these changes by editing the XML fields
in <tt>vmc_image.xml</tt> before you build your virtual machine.</p><p>The following table lists the fields in <tt>vmc_image.xml</tt>, provides the default values
for each field, and describes which fields can be edited.</p>
<hr><p><b>Note - </b>Some of the fields in this table are also used in the
other distribution constructor manifests. Many of these fields, however, are unique to the
virtual machine manifest.</p>
<hr>
<a name="fields"></a><h6>Table&nbsp;3-2 Virtual Machine Manifest Fields</h6><table><col width="56%"><col width="43%"><tr><th align="left" valign="top" scope="column"><p>Manifest Field</p></th>
<th align="left" valign="top" scope="column"><p>Description</p></th>
</tr>
<tr><td align="left" valign="top" scope="row"><pre>&lt;build_area>rpool/dc&lt;/build_area></pre></td>
<td align="left" valign="top" scope="row"><p>The build area field specifies the area where the virtual
machine will be created. You can use the default area if it is
suitable for your system, or you can specify a different build area on
the host system.</p>
<hr><p><b>Note - </b>To use checkpointing to pause and resume during the build,
you must specify a ZFS dataset, or a mount point that correlates to
a ZFS dataset, as your build area. If the ZFS dataset does not
exist, it is created during the build. The ZFS pool that you specify,
however, must already exist.</p>
<hr>
</td>
</tr>
<tr><td align="left" valign="top" scope="row"><pre>&lt;distro_constr_flags>
        &lt;stop_on_error>true&lt;/stop_on_error>
        &lt;checkpoint_enable>
            true
        &lt;/checkpoint_enable></pre></td>
<td align="left" valign="top" scope="row"><p>Within the <tt>&lt;distro_constr_flags></tt> tag, the value of true for <tt>&lt;stop_on_error></tt>
means that, if an error occurs in the build, the distribution constructor stops
running.</p><p>The value of true for <tt>&lt;checkpoint_enable></tt> gives you the ability to pause at
any specified steps, called checkpoints, when building the virtual machine, and to restart
the build at any specified checkpoints. For instructions, see <a href="distro_const.html#checkpointtask">Building an Image in Stages by Using Checkpoint Options</a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><pre>&lt;finalizer></pre></td>
<td align="left" valign="top" scope="row"><p>The <tt>finalizer</tt> section contains
a list of references to the finalizer scripts that are run when the
virtual machine is built. These scripts are used to customize the image and
are run in the order listed in this manifest.</p><p>As shown in the following
script entries, each script field includes a required <tt>checkpoint</tt> field with a name
for the checkpoint. The checkpoint marks the stage during the virtual machine build
when this script is run. The checkpoint field also contains a checkpoint message.
When the script runs, the message will display.</p><p>Each script also includes a field,
<tt>argslist</tt>, that provides any arguments that are required for that particular script to
run. You can edit these arguments as described in this table.</p>
<hr><p><b>Note - </b>The arguments are
provided within quotes. Do not remove the quotes. The quotes are used to
delineate each argument in the field.</p>
<hr>
</td>
</tr>
<tr><td align="left" valign="top" scope="row"><pre>&lt;script name="/usr/share/distro_const/vmc/prepare_ai_image">
    &lt;checkpoint
        name="prepare-image"
        message="prepare bootable ai image"/>
    &lt;argslist>
    &lt;!-- Path to bootable AI image ISO -->
        "/export/home/name_of_bootable_ai_image"
    &lt;!-- What AI client manifest to use for installation.
         "default" will use the existing AI client manifest
         included on the AI media.  To use a custom
         AI client manifest, provide a path to 
         your custom manifest -->
    "default"
 &lt;/argslist>
&lt;/script></pre><pre></pre></td>
<td align="left" valign="top" scope="row"><p>In the prior section, you modified this
<tt>prepare_ai_image</tt> script reference to point to the AI image that you have
downloaded. You can, also, in this field, provide a pointer to a custom
AI client manifest. By providing a custom AI client manifest, you can change
the default installation specifications such as defining a particular installation target or changing the
list of packages to be installed with the operating system.</p><p>Change the variable,
<tt>"default"</tt>, to the path for your custom AI client manifest. The path will
be a file path on the system where you are running the distribution
constructor, as shown in this example.</p><pre><tt>"home/user/mymanifest.xml"</tt></pre><p>For instructions about creating a custom AI
client manifest, see <a href="http://docs.sun.com/doc/820-6566/bootablemanifest?a=view">Creating a Custom Manifest in <i>OpenSolaris 2010.03 Automated Installer Guide</i></a>.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><pre>&lt;script name="/usr/share/distro_const/vmc/create_vm">
    &lt;checkpoint
        name="create-vm"
        message="create and configure virtual machine"/>
    &lt;argslist>
        "16000"
        "1536"
        "opensolaris"
    &lt;/argslist>
&lt;/script></pre></td>
<td align="left" valign="top" scope="row"><p>The <tt>create_vm</tt> script builds and configures the virtual machine. The
<tt>argslist</tt> field provides 3 arguments for the script. You can edit these arguments
as follows.</p>
<ul><li><p>Virtual machine disk size &ndash; The default is 16000 MB. Values between 12000 and 99.999.999 are valid.</p></li>
<li><p>Virtual machine ram size &ndash; The default is 1536 MB. Values between 1000 and 16,384 MB are valid.</p></li>
<li><p>Virtual machine type &ndash; The default is <tt>opensolaris</tt> for a 32&ndash;bit virtual machine. Or, use <tt>opensolaris_64</tt> for a 64&ndash;bit virtual machine.</p></li></ul>

<hr><p><b>Note - </b>The <tt>create_vm</tt> script and its arguments affect the virtual machine specifically while
it is being created. See the <tt>post_install_vm_config</tt> script below for arguments that
affect the postinstallation virtual machine.</p>
<hr>
</td>
</tr>
<tr><td align="left" valign="top" scope="row"><pre>&lt;script name="/usr/share/distro_const/vmc/install_vm">
     &lt;checkpoint
        name="install-vm"
        message="Boot and Install virtual machine"/>
&lt;/script></pre></td>
<td align="left" valign="top" scope="row"><p>The <tt>install_vm</tt> script boots and installs the virtual machine in
the build area.</p></td>
</tr>
<tr><td align="left" valign="top" scope="row"><pre>&lt;script name="/usr/share/distro_const/vmc/
post_install_vm_config">
    &lt;checkpoint
        name="post-config"
        message="Post installation virtual machine 
configuration"/>
    &lt;argslist>
        "1024"
        "1"
        "on"
    &lt;/argslist>
&lt;/script></pre></td>
<td align="left" valign="top" scope="row"><p>The <tt>post_install_vm_config</tt> script performs postinstallation configuration on the virtual machine. The
<tt>argslist</tt> field provides 3 arguments for the script. You can edit these arguments
as follows.</p>
<ul><li><p>Virtual machine ram size &ndash; The default is 1024 MB. Values between 1000 and 16,394 are valid.</p></li>
<li><p>Virtual machine number of CPUs &ndash; The default is 1 CPU. Values between 1 and 32 are valid.</p></li>
<li><p>Virtual machine VT-x/AMD&mdash;V support &ndash; Valid options are on or off.</p></li></ul>
</td>
</tr>
<tr><td align="left" valign="top" scope="row"><pre>&lt;script name="/usr/share/distro_const/vmc/export_esx">
    &lt;checkpoint
        name="export-esx"
        message="Export virtual machine for VMWare ESX"/>
    &lt;argslist>
        "esx"
    &lt;/argslist>
&lt;/script></pre></td>
<td align="left" valign="top" scope="row"><p>The <tt>export_esx</tt> script converts the virtual machine into a set of ESX
files that are ready for import. If you want your virtual machine files
to be set up in ESX format, use this script. Otherwise, comment out
this script.</p><p>For example, if you want to comment out the following field:</p><pre>&lt;sample_script>example&lt;/sample_script></pre><p>Enclose
it as follows:</p><pre>&lt;!--
&lt;sample_script>example&lt;/sample_script>
--></pre><p>The ESX virtual machine will consist of a set of
files in the <tt>build_area/media/esx</tt> folder.</p>
<hr><p><b>Note - </b>If you use both the <tt>export_esx</tt> and <tt>export_ovf</tt>
scripts, identical virtual machines for each format are created.</p>
<hr>
</td>
</tr>
<tr><td align="left" valign="top" scope="row"><pre>&lt;script name="/usr/share/distro_const/vmc/export_ovf">
    &lt;checkpoint
        name="export-ovf"
        message="Export virtual machine in OVF format"/>
    &lt;argslist>
        "ovf"
    &lt;/argslist>
&lt;/script></pre></td>
<td align="left" valign="top" scope="row"><p>The <tt>export_ovf</tt> script converts the
virtual machine into a set of OVF files that are ready for import.
 If you want your virtual machine files to be set up in
OVF format, use this script. Otherwise, comment out this script, so it will
not be run.</p><p>The OVF virtual machine will consist of a set of
files in the <tt>build_area/media/ovf</tt> folder.</p></td>
</tr>
</table>
         </div>
      </td>
   </tr>

   <tr class="PageControls" valign="top">
      <td></td>
      <td>
         <table width="100%">
      	   <tr>
      	     <td>
                 <a href="bootimage.html">Previous</a>
             </td>
             <td align="right">
                 <a href="buildvmc.html">Next</a>
             </td>
           </tr>
         </table>
      </td>
   </tr>
</tbody>
</table>


</body>
</html>

